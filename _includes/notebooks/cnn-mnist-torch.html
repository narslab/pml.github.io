<div class="jupyter-notebook-content">
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Simple-CNN-for-MNIST">Simple CNN for MNIST<a class="anchor-link" href="#Simple-CNN-for-MNIST">¶</a></h1><p>Using the MNIST dataset (70 000 pictures of hand-written digits) we will train a simple CNN, which is able to predict a digit given a picture of a hand-written digit.</p>
<p>Adapted from: <a href="https://github.com/kenophobio/keras-example-notebook">https://github.com/kenophobio/keras-example-notebook</a></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn.functional</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">F</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.optim</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">optim</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torchvision</span><span class="w"> </span><span class="kn">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">transforms</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataLoader</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="c1"># Set random seeds for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1337</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">1337</span><span class="p">)</span>
<span class="c1"># Set device</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda"</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">"cpu"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Using device: </span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>Using TensorFlow backend.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Network parameters:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">nb_classes</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">nb_epoch</span> <span class="o">=</span> <span class="mi">12</span>
<span class="c1"># input image dimensions</span>
<span class="n">img_rows</span><span class="p">,</span> <span class="n">img_cols</span> <span class="o">=</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span>
<span class="c1"># number of convolutional filters to use</span>
<span class="n">nb_filters</span> <span class="o">=</span> <span class="mi">32</span>
<span class="c1"># size of pooling area for max pooling</span>
<span class="n">pool_size</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># convolution kernel size</span>
<span class="n">kernel_size</span> <span class="o">=</span> <span class="mi">3</span>
<span class="c1"># Learning rate</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">1.0</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Prepare data into training and test set.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Define transforms</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.1307</span><span class="p">,),</span> <span class="p">(</span><span class="mf">0.3081</span><span class="p">,))</span>
<span class="p">])</span>
<span class="c1"># Load MNIST dataset</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">'./data'</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>
<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">'./data'</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>
<span class="c1"># Create data loaders</span>
<span class="n">train_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># For visualization, load the raw data</span>
<span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">targets</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">test_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">test_dataset</span><span class="o">.</span><span class="n">targets</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">targets</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">test_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">test_dataset</span><span class="o">.</span><span class="n">targets</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Downloading data from https://s3.amazonaws.com/img-datasets/mnist.npz
11493376/11490434 [==============================] - 1s 0us/step
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'gray'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Label: </span><span class="si">{</span><span class="n">y_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[ ]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x7fede7467940&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img alt="No description has been provided for this image" src="data:image/png;base64,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"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># PyTorch handles reshaping automatically through transforms</span>
<span class="c1"># Data shape info</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'X_train shape:'</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span><span class="si">}</span><span class="s1"> train samples'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">)</span><span class="si">}</span><span class="s1"> test samples'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'gray'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Label: </span><span class="si">{</span><span class="n">y_train</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img alt="No description has been provided for this image" src="data:image/png;base64,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"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Build the CNN.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Define the CNN model</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SimpleCNN</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SimpleCNN</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># First convolutional layer: 1 input channel, 32 output channels, 3x3 kernel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb_filters</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">'same'</span><span class="p">)</span>
        <span class="c1"># Second convolutional layer: 32 input channels, 32 output channels, 3x3 kernel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">nb_filters</span><span class="p">,</span> <span class="n">nb_filters</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">)</span>
        <span class="c1"># Max pooling layer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="n">pool_size</span><span class="p">,</span> <span class="n">pool_size</span><span class="p">)</span>
        <span class="c1"># Dropout layer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="c1"># Calculate the size after conv and pooling layers</span>
        <span class="c1"># After conv1 (padding='same'): 28x28</span>
        <span class="c1"># After conv2 (no padding): 26x26</span>
        <span class="c1"># After pooling (2x2): 13x13</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">nb_filters</span> <span class="o">*</span> <span class="mi">13</span> <span class="o">*</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">nb_classes</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># First conv block</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1"># Flatten</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb_filters</span> <span class="o">*</span> <span class="mi">13</span> <span class="o">*</span> <span class="mi">13</span><span class="p">)</span>
        <span class="c1"># Fully connected layers</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Create model instance</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">SimpleCNN</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="c1"># Define optimizer (Adadelta is similar to Keras default)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adadelta</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">)</span>
<span class="c1"># Define loss function</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Show a summary of the model parameters.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Display model summary</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Total parameters:"</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">numel</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Trainable parameters:"</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">numel</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to                     
====================================================================================================
convolution2d_1 (Convolution2D)  (None, 32, 26, 26)    320         convolution2d_input_1[0][0]      
____________________________________________________________________________________________________
activation_1 (Activation)        (None, 32, 26, 26)    0           convolution2d_1[0][0]            
____________________________________________________________________________________________________
convolution2d_2 (Convolution2D)  (None, 32, 24, 24)    9248        activation_1[0][0]               
____________________________________________________________________________________________________
activation_2 (Activation)        (None, 32, 24, 24)    0           convolution2d_2[0][0]            
____________________________________________________________________________________________________
maxpooling2d_1 (MaxPooling2D)    (None, 32, 12, 12)    0           activation_2[0][0]               
____________________________________________________________________________________________________
dropout_1 (Dropout)              (None, 32, 12, 12)    0           maxpooling2d_1[0][0]             
____________________________________________________________________________________________________
flatten_1 (Flatten)              (None, 4608)          0           dropout_1[0][0]                  
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 128)           589952      flatten_1[0][0]                  
____________________________________________________________________________________________________
activation_3 (Activation)        (None, 128)           0           dense_1[0][0]                    
____________________________________________________________________________________________________
dropout_2 (Dropout)              (None, 128)           0           activation_3[0][0]               
____________________________________________________________________________________________________
dense_2 (Dense)                  (None, 10)            1290        dropout_2[0][0]                  
____________________________________________________________________________________________________
activation_4 (Activation)        (None, 10)            0           dense_2[0][0]                    
====================================================================================================
Total params: 600,810
Trainable params: 600,810
Non-trainable params: 0
____________________________________________________________________________________________________
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now train the model and evaluate on the test set.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Training function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">epoch</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="n">train_loss</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">target</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="n">train_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">correct</span> <span class="o">+=</span> <span class="n">pred</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">view_as</span><span class="p">(</span><span class="n">pred</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">target</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">batch_idx</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Train Epoch: </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s1"> [</span><span class="si">{</span><span class="n">batch_idx</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span><span class="si">}</span><span class="s1"> '</span>
                  <span class="sa">f</span><span class="s1">'(</span><span class="si">{</span><span class="mf">100.</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">batch_idx</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">%)]</span><span class="se">\t</span><span class="s1">Loss: </span><span class="si">{</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">avg_loss</span> <span class="o">=</span> <span class="n">train_loss</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="mf">100.</span> <span class="o">*</span> <span class="n">correct</span> <span class="o">/</span> <span class="n">total</span>
    <span class="k">return</span> <span class="n">avg_loss</span><span class="p">,</span> <span class="n">accuracy</span>
<span class="c1"># Testing function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">test_loss</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">test_loader</span><span class="p">:</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">target</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">test_loss</span> <span class="o">+=</span> <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s1">'sum'</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
            <span class="n">pred</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">correct</span> <span class="o">+=</span> <span class="n">pred</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">view_as</span><span class="p">(</span><span class="n">pred</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">test_loss</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="mf">100.</span> <span class="o">*</span> <span class="n">correct</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Test set: Average loss: </span><span class="si">{</span><span class="n">test_loss</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">, '</span>
          <span class="sa">f</span><span class="s1">'Accuracy: </span><span class="si">{</span><span class="n">correct</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%)</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">test_loss</span><span class="p">,</span> <span class="n">accuracy</span>
<span class="c1"># Training loop</span>
<span class="n">history</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'train_loss'</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">'train_acc'</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">'val_loss'</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">'val_acc'</span><span class="p">:</span> <span class="p">[]}</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb_epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">train_loss</span><span class="p">,</span> <span class="n">train_acc</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">epoch</span><span class="p">)</span>
    <span class="n">val_loss</span><span class="p">,</span> <span class="n">val_acc</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">)</span>
    <span class="n">history</span><span class="p">[</span><span class="s1">'train_loss'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_loss</span><span class="p">)</span>
    <span class="n">history</span><span class="p">[</span><span class="s1">'train_acc'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_acc</span><span class="p">)</span>
    <span class="n">history</span><span class="p">[</span><span class="s1">'val_loss'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val_loss</span><span class="p">)</span>
    <span class="n">history</span><span class="p">[</span><span class="s1">'val_acc'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val_acc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/12
469/469 [==============================] - 39s 82ms/step - loss: 2.3025 - accuracy: 0.1171 - val_loss: 2.3023 - val_accuracy: 0.3295
Epoch 2/12
469/469 [==============================] - 40s 86ms/step - loss: 2.3023 - accuracy: 0.1963 - val_loss: 2.3022 - val_accuracy: 0.2410
Epoch 3/12
469/469 [==============================] - 35s 75ms/step - loss: 2.3022 - accuracy: 0.2015 - val_loss: 2.3021 - val_accuracy: 0.1732
Epoch 4/12
469/469 [==============================] - 37s 79ms/step - loss: 2.3022 - accuracy: 0.1845 - val_loss: 2.3021 - val_accuracy: 0.1329
Epoch 5/12
469/469 [==============================] - 45s 96ms/step - loss: 2.3022 - accuracy: 0.1708 - val_loss: 2.3021 - val_accuracy: 0.1192
Epoch 6/12
469/469 [==============================] - 45s 96ms/step - loss: 2.3021 - accuracy: 0.1593 - val_loss: 2.3021 - val_accuracy: 0.1145
Epoch 7/12
469/469 [==============================] - 47s 101ms/step - loss: 2.3021 - accuracy: 0.1494 - val_loss: 2.3020 - val_accuracy: 0.1135
Epoch 8/12
469/469 [==============================] - 48s 102ms/step - loss: 2.3021 - accuracy: 0.1407 - val_loss: 2.3020 - val_accuracy: 0.1135
Epoch 9/12
469/469 [==============================] - 44s 93ms/step - loss: 2.3021 - accuracy: 0.1373 - val_loss: 2.3020 - val_accuracy: 0.1135
Epoch 10/12
469/469 [==============================] - 45s 97ms/step - loss: 2.3021 - accuracy: 0.1311 - val_loss: 2.3020 - val_accuracy: 0.1135
Epoch 11/12
469/469 [==============================] - 41s 88ms/step - loss: 2.3020 - accuracy: 0.1289 - val_loss: 2.3020 - val_accuracy: 0.1135
Epoch 12/12
469/469 [==============================] - 33s 70ms/step - loss: 2.3020 - accuracy: 0.1236 - val_loss: 2.3020 - val_accuracy: 0.1135
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Test score:'</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Test accuracy:'</span><span class="p">,</span> <span class="n">score</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Test score: 0.0309755772928
Test accuracy: 0.9897
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">'acc'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">'val_acc'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'model accuracy'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'accuracy'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'epoch'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">'train'</span><span class="p">,</span> <span class="s1">'test'</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'upper left'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img alt="No description has been provided for this image" src="data:image/png;base64,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ug+gIL8gxk8iIq0hE8FjwICa57vvDrvtBju17bneaVE4kZy2ZuOa2uEj6basbNm2SaX5ls8ePfdgSK8h23o/kgNIr869Yv4kItKSdhQ8PvwQ1q2rvY+CR/oUTqRd21K5heWfLd/W21Hd+1H9eF1Fzf8mPTv1ZGivoQzpNYQx/ceo90MkwzZuhNWra25lZVBVBe7hVv247n1jt2XyWOvWNS949O8PHTvG8jW3Cwon0qZVVlXyyeefsHTdUpasXRLu19XcLy9bnrL3Y0y/MZw6/FT1foikaetWWLMmhIxVq2qHjvq2bdjQvPc0q7nl5aW+b+y2HbXv3l3BI04KJ9JmjZ89npVPray1YuiuXXZlUM9BDO45mHG7jVPvh0gjuIdejMYEjOpta9duf5y8PCgqqn0bNGj7bb17h/sePZoWGiR3KJxIm/WVPb7CAWMPYHCvwQzqOYg9euxBl526xF2WSKw2bw5DEOvWhcCxdm3jQsfWrdsfq0ePmiBRVAR77w0HH1w7YCTfevYMQUKkuRROZJuXX36ZZ555hilTptC9e/cWeY9bb72V4cOHM378+GYf6wcH/UAX/pN2Z9OmmnBR91ZWVv9r1beNG1Mft1On2oGif3/44hdT92gUFcEuu0CBOholJgonss1LL73EDTfcwLnnntti4eSWW27hlFNOyUg4EclGFRU7DhANhY2KitTHzcsLPRM9e4YejerH++xT87i+W1ERFBa27vcg0hwKJ7KNu8ddgkhWW7cOlizZ/rZ0ac3ZJ5s2pd43P3/70NCjR+jB2FG46NkTunbVvAvJHQonAsD111/P9ddfj5kxaNAgIFxMbMmSJQwcOJCHHnqIO+64g/nz59O5c2e+8Y1vcPvtt7P77rtvO8aiRYu48soreemll1i3bh1FRUV86Utf4r777qNbt27k5eVhZsycOZOZM2cCcM4553D//ffH8IlFtrdxYwgaqQLIkiW1Tyft0gUGDw63I46AXXdtOFx06aJwIdJYWRNOzOwi4IdAX+AN4Pvu/soO2l8EDAI+AG5x99/VafMD4AJgILAaeBS42t3r+d0md5100km8++67zJ49mzvvvJNddtkFgN69e3PzzTdz7bXXMmHCBL773e+yatUq7rrrLg477DBee+01unfvzpYtW/jGN77Bli1buOSSS+jbty8fffQRTz75JOvWraNbt248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"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">display_activation</span><span class="p">(</span><span class="n">activations</span><span class="p">,</span> <span class="n">col_size</span><span class="p">,</span> <span class="n">row_size</span><span class="p">,</span> <span class="n">act_index</span><span class="p">):</span> 
    <span class="n">activation</span> <span class="o">=</span> <span class="n">activations</span><span class="p">[</span><span class="n">act_index</span><span class="p">]</span>
    <span class="n">activation_index</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">row_size</span><span class="p">,</span> <span class="n">col_size</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">row_size</span><span class="o">*</span><span class="mf">2.5</span><span class="p">,</span><span class="n">col_size</span><span class="o">*</span><span class="mf">1.5</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">row_size</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">col_size</span><span class="p">):</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">activation</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="n">activation_index</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'gray'</span><span class="p">)</span>
            <span class="n">activation_index</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="c1">#https://www.kaggle.com/amarjeet007/visualize-cnn-with-keras        </span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#display_activation(activations, 8, 8, 1)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>